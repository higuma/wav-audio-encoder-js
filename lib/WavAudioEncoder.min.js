(function(t){var e=Math.min,n=Math.max;var a=function(t,e,n){var a=n.length;for(var s=0;s<a;++s)t.setUint8(e+s,n.charCodeAt(s))};var s=function(t,e){this.sampleRate=t;this.numChannels=e;this.numSamples=0;this.dataViews=[]};s.prototype.encode=function(t){var a=t[0].length,s=this.numChannels,i=new DataView(new ArrayBuffer(a*s*2)),r=0;for(var u=0;u<a;++u)for(var h=0;h<s;++h){var o=t[h][u]*32767;i.setInt16(r,o<0?n(o,-32768):e(o,32767),true);r+=2}this.dataViews.push(i);this.numSamples+=a};s.prototype.finish=function(t){var e=this.numChannels*this.numSamples*2,n=new DataView(new ArrayBuffer(44));a(n,0,"RIFF");n.setUint32(4,36+e,true);a(n,8,"WAVE");a(n,12,"fmt ");n.setUint32(16,16,true);n.setUint16(20,1,true);n.setUint16(22,this.numChannels,true);n.setUint32(24,this.sampleRate,true);n.setUint32(28,this.sampleRate*this.numChannels*2,true);n.setUint16(32,this.numChannels*2,true);n.setUint16(34,16,true);a(n,36,"data");n.setUint32(40,e,true);this.dataViews.unshift(n);var s=new Blob(this.dataViews,{type:"audio/wav"});this.cleanup();return s};s.prototype.cancel=s.prototype.cleanup=function(){delete this.dataViews};t.WavAudioEncoder=s})(self);
